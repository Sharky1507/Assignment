--  query to return all users who have made more than 3 orders in the last 90 days, along with their total spend. 
SELECT 
    p.customer_id,
    SUM(p.amount) AS total_spent,
    m.membership_level
FROM 
    purchases p
INNER JOIN 
    members m ON p.customer_id = m.customer_id
WHERE 
    m.membership_level = 'Gold'
GROUP BY 
    p.customer_id, m.membership_level
HAVING 
    SUM(p.amount) > 250;
